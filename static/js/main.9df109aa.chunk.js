(this.webpackJsonplistennit=this.webpackJsonplistennit||[]).push([[0],{106:function(e,t){},111:function(e,t,n){},112:function(e,t,n){"use strict";n.r(t);var r,a,o,c=n(0),u=n.n(c),i=n(49),s=n.n(i),l=n(6),f=(n(59),n(50)),p=n.n(f),m=n(51),d=n.n(m),y=(n(66),n(67),function(e){var t=e.songs,n=e.currentSong,r=e.setCurrentSong,a=e.setPlaying,o=[],c=!0,i=!1,s=void 0;try{for(var f,p=function(){var e=f.value,t=(d=Object(l.a)(e,2))[0],c=d[1],i="playlist-entry";t===n&&(i+=" playlist-entry__playing"),o.push(u.a.createElement("li",{className:i,key:t},u.a.createElement("button",{className:"playlist-entry__button",onClick:function(){r(t),a(!0)}},c.title),c.platform))},m=t.entries()[Symbol.iterator]();!(c=(f=m.next()).done);c=!0){var d;p()}}catch(y){i=!0,s=y}finally{try{c||null==m.return||m.return()}finally{if(i)throw s}}return u.a.createElement("div",{className:"playlist"},o)}),v=function(e){var t=e.playing,n=e.setPlaying,r=e.currentSong,a=e.setCurrentSong,o=e.songs,i=e.setPlaylistEvent,s=Object(c.useState)(1),f=Object(l.a)(s,2),m=f[0],v=f[1],b=Object(c.useState)(!1),g=Object(l.a)(b,2),w=g[0],E=g[1],k=void 0===o[r]?void 0:o[r].platform,O=function(){void 0===o[r+1]&&i({type:"fetchMore"}),a(r+1)},S=u.a.createRef(),j=function(e){return k===e?{ref:S,url:o[r].url,volume:m,muted:w,playing:t,onPlay:function(){return n(!0)},onPause:function(){return n(!1)},onReady:function(){return setTimeout((function(){return n(!0)}),100)},onEnded:O,onError:O,controls:!0}:{url:h[e],volume:m,muted:!0,playing:t,loop:!0,controls:!0}};return u.a.createElement(c.Fragment,null,u.a.createElement(d.a,j("youtube.com")),u.a.createElement(p.a,j("soundcloud.com")),u.a.createElement("button",{onClick:function(){return a(r>0?r-1:r)}},"Previous"),u.a.createElement("button",{onClick:function(){return n(!t)}},t?"Pause":"Play"),u.a.createElement("button",{onClick:O},"Next"),u.a.createElement("button",{onClick:function(){S.current&&S.current.seekTo(S.current.getDuration()-5)}},"Skip to end"),u.a.createElement("button",{onClick:function(){return E(!w)}},w?"Unmute":"Mute"),u.a.createElement("input",{type:"range",min:"0",max:"1",step:"0.01",defaultValue:m,onChange:function(e){return v(parseFloat(e.currentTarget.value))}}),u.a.createElement(y,{songs:o,currentSong:r,setCurrentSong:a,setPlaying:n}))},h={"youtube.com":"https://www.youtube.com/watch?v=GlCmAC4MHek","soundcloud.com":"https://soundcloud.com/seucheu/john-cage-433-8-bit-version"},b=n(11),g=n.n(b),w=n(20),E=n(52),k=n.n(E),O=n(53),S="webapp:listennit:v".concat(O.a," (by /u/twistitup)");var j,_=function(){return void 0!==a&&void 0!==r&&r.expiresOn.getTime()-1e4>Date.now()},x=function(){var e=Object(w.a)(g.a.mark((function e(){var t,n,o;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new FormData).set("grant_type","https://oauth.reddit.com/grants/installed_client"),t.set("device_id","DO_NOT_TRACK_THIS_DEVICE"),e.next=5,fetch("https://www.reddit.com/api/v1/access_token",{method:"post",headers:{authorization:"Basic ".concat(btoa("jihSDVLVs-dA0Q:"))},body:t});case 5:if((n=e.sent).ok){e.next=8;break}throw new Error("Failed to retrieve OAuth token.");case 8:return e.next=10,n.json();case 10:if(o=e.sent,"string"===typeof(c=o).access_token&&"number"===typeof c.expires_in){e.next=13;break}throw new Error("Received wrongly formatted OAuth token.");case 13:(r=o).expiresOn=new Date(Date.now()+1e3*o.expires_in),void 0!==a?a.accessToken=r.access_token:a=new k.a({userAgent:S,accessToken:r.access_token});case 16:case"end":return e.stop()}var c}),e)})));return function(){return e.apply(this,arguments)}}(),C=function(e){return void 0===e?[]:e.reduce((function(e,t){var n=P(t);return void 0===n?e:e.concat(n)}),[])},P=function(e){var t;if(null!==e.secure_media&&("youtube.com"===(t=e.secure_media.type)||"soundcloud.com"===t))return{title:e.title,commentsUrl:e.permalink,url:e.url,platform:e.secure_media.type,votes:e.score}},T=function(e){var t=e.playlistEvent,n=e.setPlaylistEvent,r=e.subreddit,c=e.listing,u=e.setListing,i=e.songs,s=e.setSongs,l=e.fetchMoreOptions;if("ready"===t.type)return null;j&&j.cancel();var f=function(){if(o)throw o;if(_())return a;throw x().catch((function(e){o=e}))}();if("refresh"===t.type||void 0===c&&"fetchMore"===t.type)throw function(){var e=Object(w.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j=f.getSubreddit(r).getHot().finally((function(){return n({type:"ready"})})),e.next=3,j;case 3:t=e.sent,u(t),s(C(t));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()();if("fetchMore"===t.type&&void 0!==c)throw function(){var e=Object(w.a)(g.a.mark((function e(){var t,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=c,r=[];case 2:if(!(r.length<=i.length)){e.next=10;break}return j=t.fetchMore(l).finally((function(){return n({type:"ready"})})),e.next=6,j;case 6:t=e.sent,r=C(t),e.next=2;break;case 10:u(t),s(r);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()();return null},M=function(){var e=Object(c.useState)({type:"refresh"}),t=Object(l.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)("lofi"),o=Object(l.a)(a,2),i=o[0],s=o[1],f=Object(c.useState)(),p=Object(l.a)(f,2),m=p[0],d=p[1],y=Object(c.useState)([]),h=Object(l.a)(y,2),b=h[0],g=h[1],w=Object(c.useState)(-1),E=Object(l.a)(w,2),k=E[0],O=E[1],S=Object(c.useState)(!1),j=Object(l.a)(S,2),_=j[0],x=j[1],C=Object(c.useState)(3),P=Object(l.a)(C,2),M=P[0],D=P[1],N=u.a.createElement("button",{onClick:function(){D(M-1),x(!_)}},"Press ",M>1?"".concat(M," times"):"once"," to unlock");return u.a.createElement(c.Fragment,null,M>0&&N,u.a.createElement("div",{className:M>0?"app__hidden":""},u.a.createElement("input",{onKeyPress:function(e){"Enter"===e.key&&(s(e.currentTarget.value),r({type:"refresh"}),O(0))}}),"Current subreddit: ",i,u.a.createElement(v,{playing:_,setPlaying:x,currentSong:k,setCurrentSong:O,songs:b,setPlaylistEvent:r}),u.a.createElement(c.Suspense,{fallback:u.a.createElement("div",null,"Loading...")},u.a.createElement(T,{playlistEvent:n,setPlaylistEvent:r,subreddit:i,listing:m,setListing:d,songs:b,setSongs:g,fetchMoreOptions:{amount:10,append:!0}})),u.a.createElement("button",{onClick:function(){r({type:"fetchMore"})}},"Fetch more")))};n(111),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(u.a.createElement(M,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},38:function(e,t){},42:function(e,t){},53:function(e){e.exports=JSON.parse('{"a":"0.1.0"}')},54:function(e,t,n){e.exports=n(112)},59:function(e,t,n){},66:function(e,t,n){},67:function(e,t,n){},73:function(e,t){},82:function(e,t){},90:function(e,t){},96:function(e,t){},98:function(e,t){}},[[54,1,2]]]);
//# sourceMappingURL=main.9df109aa.chunk.js.map